<ion-header>
  <ion-toolbar>
    <ion-title>Registro</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <ion-card>
    <ion-card-content>
      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" novalidate>

        <!-- Nombre de usuario -->
        <ion-item lines="none" [class.invalid]="username?.invalid && (username?.dirty || username?.touched)">
          <ion-label position="stacked">Nombre de usuario</ion-label>
          <ion-input formControlName="username" type="text" required></ion-input>
        </ion-item>
        <ion-text color="danger" *ngIf="username?.invalid && (username?.dirty || username?.touched)">
          <small *ngIf="username?.hasError('required')">El nombre de usuario es requerido.</small>
        </ion-text>

        <!-- Correo electrónico -->
        <ion-item lines="none" [class.invalid]="email?.invalid && (email?.dirty || email?.touched)">
          <ion-label position="stacked">Correo electrónico</ion-label>
          <ion-input formControlName="email" type="email" required></ion-input>
        </ion-item>
        <ion-text color="danger" *ngIf="email?.invalid && (email?.dirty || email?.touched)">
          <small *ngIf="email?.hasError('required')">El email es requerido.</small>
          <small *ngIf="email?.hasError('email')">El email debe ser válido.</small>
        </ion-text>

                <!-- Contraseña con toggle -->
        <ion-item lines="none" class="input-password" [class.invalid]="password?.invalid && (password?.dirty || password?.touched)">
          <ion-label position="stacked">Contraseña</ion-label>
          <ion-input
            [type]="showPassword ? 'text' : 'password'"
            formControlName="password"
            required
          ></ion-input>
          <ion-icon
            [name]="showPassword ? 'eye-off-outline' : 'eye-outline'"
            class="toggle-eye-icon"
            (click)="showPassword = !showPassword"
          ></ion-icon>
        </ion-item>

        <ion-text color="danger" *ngIf="password?.invalid && (password?.dirty || password?.touched)">
          <small *ngIf="password?.hasError('required')">La contraseña es requerida.</small>
          <small *ngIf="password?.hasError('minlength')">Mínimo 6 caracteres.</small>
          <small *ngIf="password?.hasError('pattern')">Incluye mayúscula, minúscula, número y símbolo.</small>
        </ion-text>

        <!-- Botón -->
        <ion-button
          expand="block"
          type="submit"
          [disabled]="registerForm.invalid"
          shape="round"
          class="register-button"
        >
          Registrarse
        </ion-button>

        <!-- Link de login -->
        <div class="ion-text-center" style="margin-top: 1rem;">
          <p style="font-size: 14px;">
            ¿Ya tienes cuenta?
            <a (click)="goToLogin()" style="color: var(--ion-color-primary); text-decoration: underline; cursor: pointer;">
              Inicia sesión
            </a>
          </p>
        </div>

      </form>
    </ion-card-content>
  </ion-card>
</ion-content>
